<!DOCTYPE html>
<html lang="ar">
<head>
    <meta charset="UTF-8">
    <title>AI Ù…ÙØªÙˆØ­ Ø§Ù„Ù…ØµØ¯Ø±</title>

    <script src="https://cdn.jsdelivr.net/npm/@mlc-ai/web-llm@latest"></script>

    <style>
        body { font-family: sans-serif; direction: rtl; background: #f0f0f0; padding: 20px; }
        #chat { width: 100%; max-width: 600px; margin: auto; background: white;
                padding: 20px; border-radius: 10px; box-shadow: 0 0 10px #aaa; }
        .msg { margin-bottom: 10px; padding: 10px; border-radius: 8px; }
        .user { background: #d0ebff; text-align: right; }
        .bot { background: #e6e6e6; text-align: left; }
        input { width: 100%; padding: 10px; margin-top: 10px; }
    </style>
</head>

<body>

<div id="chat"></div>
<input id="input" placeholder="Ø§ÙƒØªØ¨ Ø±Ø³Ø§Ù„ØªÙƒ..." />

<script>
    // ØªØ­Ù…ÙŠÙ„ Ù†Ù…ÙˆØ°Ø¬ Ù…ÙØªÙˆØ­ Ø§Ù„Ù…ØµØ¯Ø± â€” ÙŠØ¹Ù…Ù„ Ø¨Ø§Ù„ÙƒØ§Ù…Ù„ Ø¯Ø§Ø®Ù„ Ø§Ù„Ù…ØªØµÙØ­
    const engine = new window.WebLLM.LLMEngine();
    let loaded = false;

    async function loadModel() {
        addBot("Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠâ€¦ Ù‚Ø¯ ÙŠØ³ØªØºØ±Ù‚ 5-15 Ø«Ø§Ù†ÙŠØ©");
        await engine.reload("Llama-3.2-1B-Instruct-q4f32_1-MLC");
        loaded = true;
        addBot("ØªÙ… Ø§Ù„ØªØ­Ù…ÙŠÙ„! Ø§Ø³Ø£Ù„Ù†ÙŠ Ø£ÙŠ Ø´ÙŠØ¡ ğŸ¤–");
    }

    loadModel();

    function addUser(text) {
        chat.innerHTML += `<div class="msg user">${text}</div>`;
    }
    function addBot(text) {
        chat.innerHTML += `<div class="msg bot">${text}</div>`;
    }

    input.addEventListener("keydown", async (e) => {
        if (e.key === "Enter" && input.value.trim() !== "" && loaded) {
            const userMsg = input.value;
            addUser(userMsg);
            input.value = "";

            // Ø·Ù„Ø¨ Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ
            const reply = await engine.chat.completions.create({
                messages: [
                    { role: "user", content: userMsg }
                ],
                stream: false
            });

            addBot(reply.choices[0].message.content);
        }
    });
</script>

</body>
</html>